<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iPad-Koffer Reservierung</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1em;
      background: #f4f4f4;
      margin: 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1em;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5em;
      text-align: center;
      font-size: 0.9em;
    }
    th {
      background: #e0e0e0;
    }
    th.koffer-gelb { color: goldenrod; }
    th.koffer-gruen { color: green; }
    th.koffer-blau  { color: blue; }
    th.koffer-rot   { color: red; }
    select {
      width: 100%;
      padding: 0.4em;
      font-size: 1em;
    }
    .hinweis {
      margin-top: 2em;
      font-style: italic;
      text-align: center;
      color: #555;
    }
    #login {
      max-width: 400px;
      margin: 2em auto;
      padding: 1em;
      background: white;
      border-radius: 0.5em;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    #login input, #login button {
      width: 100%;
      padding: 0.5em;
      margin-bottom: 0.5em;
      font-size: 1em;
    }
    #content {
      display: none;
    }
  </style>
</head>
<body>
  <div id="login">
    <h2>Passwort eingeben</h2>
    <input type="password" id="pw" placeholder="Passwort">
    <button onclick="checkPassword()">OK</button>
    <p id="error" style="color: red; display: none;">Falsches Passwort</p>
  </div>

  <div id="content">
    <h1>iPad-Koffer Reservierung</h1>
    <table>
      <thead>
        <tr>
          <th></th>
          <th class="koffer-gelb">Koffer Gelb</th>
          <th class="koffer-gruen">Koffer Grün</th>
          <th class="koffer-blau">Koffer Blau</th>
          <th class="koffer-rot">Koffer Rot</th>
        </tr>
      </thead>
      <tbody id="reservierungstabelle"></tbody>
    </table>
    <div class="hinweis">
      Bitte denke daran, die iPads nach dem Zurückbringen wieder an die Ladekabel anzuschließen.
    </div>
  </div>

  <script>
    function checkPassword() {
      const input = document.getElementById("pw").value;
      if (input === "sjs") {
        document.getElementById("login").style.display = "none";
        document.getElementById("content").style.display = "block";
        baueTabelle();
      } else {
        document.getElementById("error").style.display = "block";
      }
    }

    const klassen = [
      "", "VSK1", "VSK2", "VSK3", "1A", "1B", "1C", "1D",
      "2A", "2B", "2C", "2D", "2E", "3A", "3B", "3C", "3D",
      "4A", "4B", "4C", "4D"
    ];

    const zeilen = ["Sprfö", "1. Std.", "2. Std.", "3. Std.", "4. Std."];
    const spalten = ["Gelb", "Grün", "Blau", "Rot"];
    const heute = new Date().toDateString();

    function ladeStatus() {
      let status = JSON.parse(localStorage.getItem("reservierungStatus")) || {};
      if (status.datum !== heute) {
        status = {
          datum: heute,
          belegung: Array(zeilen.length).fill(0).map(() => Array(spalten.length).fill(""))
        };
        localStorage.setItem("reservierungStatus", JSON.stringify(status));
      }
      return status;
    }

    function speichereStatus(status) {
      localStorage.setItem("reservierungStatus", JSON.stringify(status));
    }

    function baueTabelle() {
      const tbody = document.getElementById("reservierungstabelle");
      tbody.innerHTML = "";
      const status = ladeStatus();

      zeilen.forEach((zeilenName, zeilenIndex) => {
        const tr = document.createElement("tr");
        const th = document.createElement("th");
        th.textContent = zeilenName;
        tr.appendChild(th);

        spalten.forEach((_, spaltenIndex) => {
          const td = document.createElement("td");
          const select = document.createElement("select");

          klassen.forEach(klasse => {
            const option = document.createElement("option");
            option.value = klasse;
            option.textContent = klasse === "" ? "Frei" : klasse;
            if (status.belegung[zeilenIndex][spaltenIndex] === klasse) {
              option.selected = true;
            }
            select.appendChild(option);
          });

          select.onchange = () => {
            status.belegung[zeilenIndex][spaltenIndex] = select.value;
            speichereStatus(status);
          };

          td.appendChild(select);
          tr.appendChild(td);
        });

        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>
